<!DOCTYPE html>
<html>
<head>
	<title>SQL Form</title>
	<link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,600italic,700italic,400,600,700|Open+Sans+Condensed:300,300italic,700">
	<link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
	<link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet">
	<link href="simpleblimp/style.css" rel="stylesheet">
	<style>
		body { font-family: 'open sans'; min-width: 960px; }
		a { cursor: pointer; color: #3498db; }

		.has_fixed_header { padding-top: 70px; }

		.sb_nav { float: left; }
		.sb_nav.sb_nav_right { float: right; }
		.sb_nav > a, .sb_nav .dropdown > a { color: #fff; color: rgba(255, 255, 255, 0.6); padding: 15px 0; float: left; margin-right: 30px; }
		.sb_nav.sb_nav_right > a, .sb_nav.sb_nav_right .dropdown > a { margin-right: 0; margin-left: 30px; }
		.sb_nav > a:hover, .sb_nav .dropdown > a:hover { text-decoration: none; color: #fff; }

		/*.nav > li > a { padding: 5px 12px; margin-top: 6px; cursor: pointer; }*/
		.form-horizontal .control-label { text-align: left; }

		.form-control, .form-control:focus { box-shadow: 0 0; }
		.form-control:focus { border-color: #2980b9; }

		.container-sb { max-width: 1440px; min-width: 960px; margin-left: auto; margin-right: auto; padding-right: 40px; padding-left: 40px; }

		.sql-panel-tabs { margin: -10px -12px -10px -15px; border: 0; }
		.sql-panel-tabs > li > a { padding: 5px 12px; margin-top: 6px; cursor: pointer; }

		.sb-tabs { margin: 0 0 20px; padding: 0; border-bottom: solid 1px #eee; list-style: none; font-size: 12px; }
		.sb-tabs > li { display: inline-block; }
		.sb-tabs > li > a { padding: 8px 0; display: block; color: #aaa; margin: 0 20px -1px 0; }
		.sb-tabs > li.active > a, .sb-tabs > li > a:hover { border-bottom: solid 3px #3498db; color: #000; text-decoration: none; }

		.popover { font-size: 11px; }

		.input-group-addon.middle-addon { border-width: 1px 0; }

		#header { background: #0E2C40; color: #fff; font-size: 12px; line-height: 20px; margin-bottom: 20px; }
		#header { position: fixed; width: 100%; z-index: 1; margin-bottom: 0; }
		#header #account_dropdown { border: 0; box-shadow: 0 0; margin: 0 -15px 0 0; border-radius: 0; background: #0E2C40; font-size: 12px; padding-top: 0; }
		#header #account_dropdown li.divider { background-color: rgba(255, 255, 255, 0.2); margin: 5px 0; }
		#header #account_dropdown li a { color: #fff; color: rgba(255, 255, 255, 0.6); padding: 3px 15px; }
		#header #account_dropdown li a:hover { background: rgba(255, 255, 255, 0.2); color: #fff; }
		#header #blimps_dropdown { border: 0; box-shadow: 0 0; margin: 0 0 0 -15px; border-radius: 0; background: #0E2C40; font-size: 12px; padding-top: 0; }
		#header #blimps_dropdown li.divider { background-color: rgba(255, 255, 255, 0.2); margin: 5px 0; }
		#header #blimps_dropdown li a { color: #fff; color: rgba(255, 255, 255, 0.6); padding: 3px 15px; }
		#header #blimps_dropdown li a:hover { background: rgba(255, 255, 255, 0.2); color: #fff; }

		#logo { text-transform: uppercase; line-height: 20px; font-size: 14px; }

		#profile_dropdown_image { margin-top: -2px; margin-right: 3px; }
	</style>
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/2.4.1/lodash.min.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
	<script src="sqlform.js"></script>
</head>
<body>
	<header id="header" class="clearfix">
		<div class="container-sb">
			<div class="col-xs-12">
				<div class="sb_nav">
					<a id="logo" class="sb-icon-">Simpleblimp</a>
					<div class="dropdown pull-left">
						<a class="dropdown-toggle" data-toggle="dropdown">
							Scvngr
							<span class="caret"></span>
						</a>
						<ul id="blimps_dropdown" class="dropdown-menu">
							<li><a role="menuitem" href="#">Scvngr</a></li>
							<li><a role="menuitem" href="#">Tasty Trailers</a></li>
							<li><a role="menuitem" href="#">Demo</a></li>
							<li class="divider"></li>
							<li><a role="menuitem" href="#">New Blimp</a></li>
						</ul>
					</div>
					<a href="">Dashboard</a>
					<a href="">Tables</a>
					<a href="">URLs</a>
					<a href="">API Keys</a>
					<a href="">Settings</a>
					<a href="">SQL</a>
					<a href="">Team</a>
					<a href="">Log</a>
				</div>
				<div class="sb_nav sb_nav_right">
					<a href="">Documentation</a>
					<a href="">New Blimp</a>
					<div class="pull-left dropdown">
						<a class="dropdown-toggle" data-toggle="dropdown">
							<img src="http://www.gravatar.com/avatar/4ff773eb93037d8f1d97875121e225ac" width="20" height="20" class="img-circle" id="profile_dropdown_image">
							<span class="caret"></span>
						</a>
						<ul id="account_dropdown" class="dropdown-menu dropdown-menu-right">
							<li><a role="menuitem" href="#">Account</a></li>
							<li><a role="menuitem" href="#">Payment Method</a></li>
							<li class="divider"></li>
							<li><a role="menuitem" href="#">Logout</a></li>
						</ul>
					</div>
				</div>
			</div>
		</div>
	</header>
	<div class="container-sb has_fixed_header">
		<div class="col-xs-12">
			<h4>Table Name</h4>
			<ul class="sb-tabs">
				<li class="active"><a href="#">Home</a></li>
				<li><a href="#">Profile</a></li>
				<li><a href="#">Messages</a></li>
			</ul>
			<div id="form"></div>
		</div>
	</div>

	<script id="sql_form_template" type="text/template">
		<div class="form-group row">
			<div class="col-xs-6">
				<label for="method">Method</label>
				<select class="form-control input-sm" id="method" name="method"><option selected="selected" value="get">GET</option>
					<option value="post">POST</option>
					<option value="put">PUT</option>
					<option value="delete">DELETE</option>
				</select>
			</div>
		</div>
		<div class="form-group row">
			<div class="col-xs-6">
				<label for="url">URL</label>
				<input type="text" class="form-control input-sm" name="url" id="url" value="/scavenger/:number" required="">
			</div>
		</div>
		<div>
			<label>SQL Builder</label>
		</div>
		<div class="panel panel-default">
			<div class="panel-heading clearfix">
				<ul class="nav nav-tabs pull-right sql-panel-tabs">
					<li class="<%= (activeTab == 0) ? 'active' : '' %>"><a data-tab="0">Simple</a></li>
					<li class="<%= (activeTab == 1) ? 'active' : '' %>"><a data-tab="1">Advanced</a></li>
				</ul>
			</div>
			<% if (activeTab == 0) { %>
			<div class="panel-body">
				<div class="form-horizontal">
					<div class="form-group">
						<label class="col-xs-2 control-label">Table</label>
						<div class="col-xs-10">
							<select id="sql_form_table" class="form-control input-sm">
								<option value="">Select a Table</option>
								<% _.forEach(schema, function (v, k) { %>
									<option value="<%= k %>" <%= (k == tableSelected) ? 'selected' : '' %>><%= k %></option>
								<% }); %>
							</select>
						</div>
					</div>
					<div class="form-group">
						<label class="col-xs-2 control-label">
							Action
							<i class="glyphicon glyphicon-question-sign text-muted" data-container="body" data-toggle="popover" data-placement="right" data-content="Action refers to the type of query that will be executed. More info can be found in the documentation." data-trigger="hover" data-html="true"></i>
						</label>
						<div class="col-xs-10">
							<select id="sql_form_action" class="form-control input-sm" <%= (tableSelected == '') ? 'disabled' : '' %>>
								<option value="">Select an Action</option>
								<option <%= (actionSelected == 'select') ? 'selected' : '' %>>select</option>
								<option <%= (actionSelected == 'insert') ? 'selected' : '' %>>insert</option>
								<option <%= (actionSelected == 'update') ? 'selected' : '' %>>update</option>
								<option <%= (actionSelected == 'delete') ? 'selected' : '' %>>delete</option>
							</select>
						</div>
					</div>
					<% if (tableSelected != '') { %>
						<% if ([ 'select' ].indexOf(actionSelected) > -1) { %>
						<div class="form-group">
							<label class="col-xs-2 control-label">Columns</label>
							<div id="sql_form_column" class="col-xs-10">
								<% _.forEach(schema[tableSelected], function (v) { %>
									<div class="checkbox">
										<label><input type="checkbox" value="<%= v.name %>" <%= (v.selected) ? 'checked' : '' %> /> <%= v.name %></label>
									</div>
								<% }); %>
							</div>
						</div>
						<% } %>
						<% if ([ 'insert', 'update' ].indexOf(actionSelected) > -1) { %>
						<div class="form-group">
							<label class="col-xs-2 control-label">Values</label>
							<div class="col-xs-10">
								<% _.forEach(schema[tableSelected], function (v) { %>
									<div class="form-group">
										<div class="col-xs-3">
											<label class="control-label"><%= v.name %></label>
										</div>
										<div class="col-xs-3">
											<input class="form-control input-sm column_value_attribute" type="text" placeholder="value" value="<%= v.value %>" data-attribute="<%= v.name %>">
										</div>
									</div>
								<% }); %>
							</div>
						</div>
						<% } %>
						<% if ([ 'select', 'update', 'delete' ].indexOf(actionSelected) > -1) { %>
						<div class="form-group">
							<label class="col-xs-2 control-label">Filters</label>
							<div class="col-xs-10">
								<% _.forEach(whereFilters, function (v) { %>
								<div class="form-group where_filter_group">
									<div class="col-xs-3">
										<select class="form-control input-sm input-sm input-sm where_filter_attribute" data-attribute="column">
											<option value="">Select a Column</option>
											<% _.forEach(schema[tableSelected], function (h) { %>
												<option value="<%= h.name %>" <%= (v.column == h.name) ? 'selected' : '' %>><%= h.name %></option>
											<% }); %>
										</select>
									</div>
									<div class="col-xs-3">
										<select class="form-control input-sm input-sm where_filter_attribute" data-attribute="comparator">
											<% _.forEach(comparatorOptions, function (h) { %>
												<option value="<%= h.value %>" <%= (v.comparator == h.value) ? 'selected' : '' %>><%= h.name %></option>
											<% }); %>
										</select>
									</div>
									<div class="col-xs-3">
										<input class="form-control input-sm where_filter_attribute" type="text" placeholder="value" value="<%= v.value %>" data-attribute="value" />
									</div>
									<div class="col-xs-3">
										<a class="btn btn-danger btn-sm remove_where_filter_link"><i class="glyphicon glyphicon-remove"></i></a>
									</div>
								</div>
								<% }); %>
								<div class="row">
									<div class="col-xs-12">
										<a id="add_where_filter_link" class="btn btn-success btn-xs"><i class="glyphicon glyphicon-plus"></i> Filter</a>
									</div>
								</div>
							</div>
						</div>
						<% } %>
						<% if ([ 'select' ].indexOf(actionSelected) > -1) { %>
						<div class="form-group">
							<label class="col-xs-2 control-label">Sort</label>
							<div class="col-xs-10">
								<% _.forEach(orderBy, function (v) { %>
								<div class="form-group order_by_group">
									<div class="col-xs-3">
										<select class="form-control input-sm order_by_attribute" data-attribute="column">
											<option value="">Select an Column</option>
											<% _.forEach(schema[tableSelected], function (h) { %>
												<option value="<%= h.name %>" <%= (v.column == h.name) ? 'selected' : '' %>><%= h.name %></option>
											<% }); %>
										</select>
									</div>
									<div class="col-xs-3">
										<select class="form-control input-sm order_by_attribute" data-attribute="direction">
											<% _.forEach(sortOptions, function (h) { %>
												<option value="<%= h.value %>" <%= (v.direction == h.value) ? 'selected' : '' %>><%= h.name %></option>
											<% }); %>
										</select>
									</div>
									<div class="col-xs-3" v-if="orderBy.length > 1">
										<a class="btn btn-danger btn-sm remove_order_by_link"><i class="glyphicon glyphicon-remove"></i></a>
									</div>
								</div>
								<% }); %>
								<div class="row">
									<div class="col-xs-12">
										<a id="add_order_by_link" class="btn btn-success btn-xs"><i class="glyphicon glyphicon-plus"></i> Parameter</a>
									</div>
								</div>
							</div>
						</div>
						<% } %>
					<% } %>
				</div>
			</div>
			<% } else if (activeTab == 1) { %>
			<div class="panel-body">
				<textarea id="raw_sql_textarea" class="form-control" rows="10"><%= rawSql %></textarea>
			</div>
			<% } %>
		</div>
		<div class="form-group">
			<form action="" method="get">
				<input type="submit" value="Save" id="save_url_button" class="btn btn-primary" name="submit">
				<a href="#" id="delete_url_link" class="btn btn-danger pull-right" data-original-title="" title="">
					<i class="glyphicon glyphicon-remove"></i> Delete URL
				</a>
				<input type="hidden" name="sql">
				<div class="row">
					<div class="col-xs-12">
						<br />
						<textarea class="form-control" rows="10"></textarea>
						<br />
					</div>
				</div>
			</form>
		</div>
	</script>

	<script>
		[].slice.call(document.querySelectorAll('.sb-icon-')).forEach(function (v) {
			v.innerHTML = (v.text.toLowerCase() == 'simpleblimp') ? '&#xe600;' : v.innerHTML;
		});
	</script>
</body>
</html>
